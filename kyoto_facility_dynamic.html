
<!DOCTYPE html>
<html lang='ja'>
<head>
  <meta charset='UTF-8'>
  <title>施設案内ページ</title>
  <style>
    body { font-family: sans-serif; padding: 2em; background: #f9f9f9; }
    h1 { color: #2c3e50; }
    p { margin: 0.5em 0; }
    .label { font-weight: bold; }
  </style>
</head>
<body>
  <h1 id='name'>施設名</h1>
  <p><span class='label'>住所:</span> <span id='address'></span></p>
  <p><span class='label'>電話番号:</span> <span id='phone'></span></p>
  <p><span class='label'>メール:</span> <span id='email'></span></p>
  <p><span class='label'>説明:</span> <span id='description'></span></p>
  <p><span class='label'>公式サイト:</span> <a id='url' href='#' target='_blank'>リンク</a></p>

  <script>
    const params = new URLSearchParams(window.location.search);
    const facilityName = params.get("name");

    if (!facilityName) {
      document.body.innerHTML = "<p>施設名が指定されていません。URLに ?name=施設名 を付けてください。</p>";
    } else {
      const apiUrl = "https://data.bodik.jp/api/3/action/datastore_search";
      const resourceId = "aa1b14ae-a824-4762-8f33-e45d22b61c58";
      const filters = encodeURIComponent(JSON.stringify({ "名称": facilityName }));

      fetch(`${apiUrl}?resource_id=${resourceId}&filters=${filters}`)
        .then(response => response.json())
        .then(data => {
          if (data.result.records.length === 0) {
            document.body.innerHTML = `<p>施設「${facilityName}」の情報が見つかりませんでした。</p>`;
            return;
          }
          const record = data.result.records[0];
          document.getElementById("name").textContent = record["名称"];
          document.getElementById("address").textContent = record["所在地_連結表記"];
          document.getElementById("phone").textContent = record["電話番号"];
          document.getElementById("email").textContent = record["連絡先メールアドレス"];
          document.getElementById("description").textContent = record["説明"];
          document.getElementById("url").href = record["URL"];
          document.getElementById("url").textContent = record["URL"];
        })
        .catch(error => {
          document.body.innerHTML = "<p>データの取得に失敗しました。</p>";
          console.error("APIエラー:", error);
        });
    }
  </script>
</body>
</html>
